\documentclass[dvipdfmx]{jsbook}

% Language setting
% Replace `english' with e.g. `spanish' to change the document language

% Set page size and margins
% Replace `letterpaper' with `a4paper' for UK/EU standard size
\usepackage[letterpaper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}

% Useful packages
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
\usepackage{tikz-cd}
\usepackage{amsthm}
\usepackage{mathrsfs} 
\theoremstyle{plain}
\newtheorem{thm}{定理}[chapter]
\newtheorem{Def}{定義}[chapter]
\newtheorem{Notation}{記法}[chapter]
\newtheorem{Prop}{命題}[chapter]
\newtheorem{caution}{注意}[chapter]
\newtheorem{example}{例}[chapter]
\usepackage{makeidx}
\usepackage{comment}
\usepackage{listings}
\lstset{
	%プログラム言語(複数の言語に対応，C,C++も可)
 	language = haskell,
 	%背景色と透過度
 	backgroundcolor={\color[gray]{.90}},
 	%枠外に行った時の自動改行
 	breaklines = true,
 	%自動開業後のインデント量(デフォルトでは20[pt])	
 	breakindent = 10pt,
 	%標準の書体
 	basicstyle = \ttfamily\scriptsize,
 	%basicstyle = {\small}
 	%コメントの書体
 	commentstyle = {\itshape \color[cmyk]{1,0.4,1,0}},
 	%関数名等の色の設定
 	classoffset = 0,
 	%キーワード(int, ifなど)の書体
 	keywordstyle = {\bfseries \color[cmyk]{0,1,0,0}},
 	%""で囲まれたなどの"文字"の書体
 	stringstyle = {\ttfamily \color[rgb]{0,0,1}},
 	%枠 "t"は上に線を記載, "T"は上に二重線を記載
	%他オプション：leftline，topline，bottomline，lines，single，shadowbox
 	frame = TBrl,
 	%frameまでの間隔(行番号とプログラムの間)
 	framesep = 5pt,
 	%行番号の位置
 	numbers = left,
	%行番号の間隔
 	stepnumber = 1,
	%右マージン
 	%xrightmargin=0zw,
 	%左マージン
	%xleftmargin=3zw,
	%行番号の書体
 	numberstyle = \tiny,
	%タブの大きさ
 	tabsize = 4,
 	%キャプションの場所("tb"ならば上下両方に記載)
 	captionpos = t
}

\makeindex
\title{圏論入門workflow test}
\author{Hirokichi Tanaka}

\begin{document}
\maketitle

\tableofcontents
\newpage
\chapter{集合とユニバース}
\begin{Def}
順序集合
\end{Def}
\begin{Def}
べき集合
\end{Def}
\begin{Def}
ユニバース
\end{Def}
\begin{Def}
小さい集合
\end{Def}
\begin{Prop}
ユニバース$U$は小さい集合ではない
\end{Prop}
内包原理

\begin{Def}
クラス
\end{Def}
\begin{Prop}
ユニバース$U$はクラスである.
\end{Prop}
\begin{Def}
真のクラス
\end{Def}
\begin{Prop}
ユニバース$U$は真のクラスである.
\end{Prop}
\chapter{圏・関手}
\section{二項関係・部分関数・写像（関数）}
\begin{Def}
集合$A,B$に対して$R\subset A\times B$であるとき, {\bf $R$は$A$と$B$の二項関係}\index{にこうかんけい@二項関係}であるという.
\end{Def}
\begin{Def}
$R$が集合$A,B$の二項関係であるとする.

各集合の要素$a\in A$と$b\in B$について$(a,b)\in R$であるとき,
{\bf $a$と$b$に間に$R$の関係\index{かんけい@関係}がある}という.
\end{Def}
\begin{Notation}
$a$と$b$の間に$R$の関係があることを$aRb$と表す.
\end{Notation}
\begin{Def}
$R$が集合$A,B$の二項関係であるとする.

任意の$a\in A$について, とある$b\in B$が一意に存在して$aRb$となるとき,
{\bf $R$は$A$から$B$への写像\index{しゃぞう@写像}である}という.
\end{Def}
\begin{caution}
以下では, 「{\bf 関数\index{かんすう@関数}}」と「写像」を同じ意味で用いる.
\end{caution}
\begin{Def}
$R$が集合$A,B$の二項関係であるとする.

任意の$a\in A$について$b,b'\in B$が存在し,
\[
aRb\land aRb'\Rightarrow b=b'
\]
が成り立つとき, {\bf $R$は$A$から$B$への部分関数\index{ぶぶんかんすう@部分関数}}という.
\end{Def}
\begin{Prop}
関数は部分関数である. これは定義より明らかである.
\end{Prop}
\begin{Prop}
部分関数は二項関係である. これは定義より明らかである.
\end{Prop}
\subsection{合成と結合律}
\begin{Def}
集合$A,B,C$に対する2つの写像$f:A\rightarrow B$と$g:B\Rightarrow C$について, その{\bf 合成写像} $g\circ f:A\rightarrow C$を
\[
(g\circ f)(a)=g(f(a))
\]
で定義する. ここで$a$は$A$の要素である.
\end{Def}
\begin{Def}
部分関数の合成
\end{Def}
\begin{Def}
二項関係の合成を次で定義する

...
\end{Def}
\begin{Prop}
二項関係の合成は結合律を満たす
\end{Prop}
\begin{caution}
一般に, 結合律とは...
\end{caution}
\begin{Prop}
写像の合成は{\bf 結合律}を満たす.
すなわち, 集合$A,B,C,D$に対する3つの写像$f:A\rightarrow B, g:B\rightarrow C,
h:C\rightarrow D$について
\[
(h\circ g)\circ f=h\circ(g\circ f)
\]
が成り立つ.
\end{Prop}
\begin{Prop}
部分関数の合成は結合律を満たす.
\end{Prop}
\section{群・準同型写像・同型写像}
\begin{Def}
群
\end{Def}
\begin{Def}
準同型写像
\end{Def}
\begin{Def}
同型写像
\end{Def}
\begin{Def}
{\bf アーベル群}\index{あーべるぐん@アーベル群}
\end{Def}
\begin{Def}
$n$次ホモロジー群
\end{Def}
\section{圏}
\begin{Def}
{\bf 圏}$\mathscr{C}$は{\bf 対象}の集合$\mathrm{Obj}(\mathscr{C})$と
{\bf 射}の集合$\mathrm{Mor}(\mathscr{C})$からなる, 以下の演算が定義されているもののことをいう.
\begin{enumerate}
\item 射$f\in\mathrm{Mor}(\mathscr{C})$には{\bf 始域}$\mathrm{dom}f$および{\bf 終域}$\mathrm{cod}f$となる対象がそれぞれ一意に定まる\footnote{$\mathrm{dom}f=A\in\mathrm{Obj}(\mathscr{C}),\mathrm{cod}f=B\in\mathrm{Obj}(\mathscr{C})$のとき$f:A\rightarrow B$とかく.}
\item $\mathrm{dom} g=\mathrm{cod}f$を満たす射$f,g\in\mathrm{Mor}(\mathscr{C})$に対して,
{\bf 合成射}$g\circ f:\mathrm{dom}f\rightarrow\mathrm{cod}g$が一意に定まる
\item 射の合成は結合律を満たす. すなわち, 対象$A,B,C,D\in\rm{Obj}$についての射の列$f,g,h$が与えられたとき
\[
h\circ(g\circ f)=(h\circ g)\circ f
\]
が成り立つ.
\item 任意の対象$A\in\mathrm{Obj}(\mathscr{C})$について,
次の条件を満たす{\bf 恒等射}$1_{A}:A\rightarrow A$が存在する\footnote{恒等写$1_{A}$は一意に定まるので, 定義に一意性を加えても問題ない.}

条件：任意の射の組$f:A\rightarrow B, g:B\rightarrow A$に対して
$f\circ 1_A=f$かつ$1_A\circ g=g$
\end{enumerate}
\end{Def}
\begin{Def}
同型射と逆射
\end{Def}
\begin{Notation}
圏$\mathscr{C}$の対象$A,B$に対して$f:A\rightarrow B$となる射の全体を$\mathrm{Hom}_{\mathscr{C}}(A,B)$で表す.
\end{Notation}
\begin{Prop}
ある射の逆射は存在すれば, 一意に定まる
\end{Prop}
\subsection{情報隠蔽された対象の探究に圏論が提供する方法論}
オブジェクト指向プログラミングでは,「知らせる必要のない情報は隠蔽しておくほうが安全である」という{\bf 情報隠蔽}の考え方が重要視される.
これに対して, 圏論は, 対象がもつ情報が隠蔽されている状況下で, 射のみから対象について探究するという方法論を提供する.
\begin{example}
どのような要素をもつかわからない集合$A$について写像$f:A\rightarrow A$が定義されていて$f\circ f\circ f$が恒等写像になるとする.
このとき$A$が3つの要素$a_1,a_2,a_3$をもつと仮定することができ,
\[
f(a_1)=a_2, f(a_2)=a_3, 
f(a_3)=a_1
\]
というように, これらの要素が写像$f$によって回転していると考えることができる.
\end{example}
\subsection{小圏・局所小圏・大圏}
\begin{Def}
小圏
\end{Def}
\begin{example}
順序集合は小圏である.
\end{example}
\begin{Def}
局所小圏
\end{Def}
\begin{Def}
大圏
\end{Def}

\begin{example}
すべての小さな集合を対象とし, それらの間の写像を射とする圏$\mathrm{Set}$は大圏である.
\end{example}
\begin{example}
すべての群を対象とし, それらの間の準同型写像を射とする圏$\mathrm{Grp}$は大圏である.
\end{example}
\begin{example}
すべてのアーベル群を対象とし, それらの間の準同型写像を射とする圏$\mathrm{Ab}$は大圏である.
\end{example}
\begin{example}
すべての位相空間を対象とし, それらの間の連続写像を射とする圏$\mathrm{Top}$は大圏である.
\end{example}
\begin{example}
$\mathrm{Vect}_k$は大圏である.
\end{example}
\subsection{部分圏}
\begin{Def}
部分圏
\end{Def}
\begin{example}
圏$\mathrm{Ab}$は圏$\mathrm{Grp}$の部分圏である.
\end{example}
\subsection{双対}
\begin{Def}
任意の圏$\mathscr{C}$に対して, 対象が$\mathscr{C}$と同じで, 射の向きが$\mathcal{C}$と反対になっている圏を\bf{双対圏}\index{そうついけん@双対圏}という.
\end{Def}
\begin{Notation}
圏$\mathscr{C}$の双対圏を$\mathscr{C}^{\mathrm{op}}$と表す.
\end{Notation}
\begin{caution}
双対の原理
\end{caution}
\subsection{圏の生成}
\begin{Def}
生成元
\end{Def}
\begin{Def}
生成系
\end{Def}
\begin{Def}
圏の積
\end{Def}
\section{関手・反変関手}
\begin{Def}
圏$\mathscr{A}$から$\mathscr{B}$への{\bf 関手}は{\bf 対象関数}$F_0:\mathrm{Obj}(\mathscr{A})\rightarrow\mathrm{Obj}(\mathscr{B})$と
{\bf 射関数}$F_1$からなるもののことをいう.
\end{Def}
\begin{Def}
{\bf 反変関手}
\end{Def}

\section{忠実関手と充満関手}
\begin{Def}
{\bf 忠実}
\end{Def}
\begin{Def}
{\bf 充満}
\end{Def}
\begin{Def}
{\bf 充満忠実}
\end{Def}
\begin{Def}
{\bf 充満部分圏}
\end{Def}
\section{Haskellにおける圏 (Hask)}
Haskellには標準ライブラリに\verb|Int|, \verb|Integer|, 
\verb|Char|,
\verb|Float|,
\verb|Double|,
\verb|Bool|
などの型が定義済みである.
これらをもとにタプル,リストあるいは\verb|Maybe|のような型構築子によって新たな型を無限に作り出すことができる.
\begin{example}
\verb|[Integer]|, \verb|Maybe Int|,
\verb|(Int,[Char])| などはすべてHaskellの型である.
\end{example}

すべてのHaskellの型を対象とし, それらの間の関数を射とする圏Haskは小圏である.
\begin{caution}
Haskellにおいて, 型\verb|A|,\verb|B|に対して, 型構築子によってつくられる\verb|A->B|は1つの型となる.
\end{caution}

\subsection{型構築子と関手}
\subsubsection{List関手}
Haskellにおける型構築子\verb|[]|は任意の型\verb|A|に対して型\verb|[A]|を対応させる.
これは, HaskからHaskへの対称関数とみなせる.
型\verb|A|と型\verb|B|および関数\verb|f::A->B|が与えられとき\verb|map f::[A]->[B]|が決定される.

...

型構築子\verb|[]|は{\bf List関手}\index{りすとかんしゅ@List関手}と呼ばれる
\subsubsection{Maybe関手}
Haskellにおける型構築子\verb|Maybe|は...

...

型構築子\verb|Maybe|は{\bf Maybe関手}\index{めいびーかんしゅ@Maybe関手}
と呼ばれる.
\subsubsection{Tree関手}
一般に木構造を生成する型構築子は関手にできる. これを{\bf Tree関手}と呼ぶ.

\lstinputlisting{chap2/Tree.hs}
\subsection{２変数の関手}
\subsection{Haskの部分圏}
\chapter{自然変換・定数関手}
\section{自然変換}
\begin{Def}
{\bf 自然変換}\index{しぜんへんかん@自然変換}
\end{Def}
\section{定数関手}
\begin{Def}
{\bf 定数関手}\index{ていすうかんしゅ@定数関手}
\end{Def}
\begin{Def}
\end{Def}
\section{Haskにおける自然変換・定数関手}
\subsection{Haskにおける自然変換}
\subsubsection{concat}
\subsubsection{safehead}
\subsubsection{concatとsafeheadの垂直合成}
\subsubsection{flatten関数}
\subsection{Haskにおける定数関手}
\subsubsection{length関数}
\subsection{Haskの部分圏}
\chapter{関手圏・圏同値}
\section{関手圏}
\begin{Def}
\bf{自然同型}
\end{Def}
\section{圏同値}
\begin{Def}
\bf{圏同値}
\end{Def}
\section{Haskにおける...}

\subsection{Haskにおける自然同型}
\subsubsection{mirror関数}
\subsubsection{Maybe関手とEither()関手の間の自然同型}
\chapter{普遍性と極限}
\section{始対象・終対象}
\section{積}
\section{余積}
\section{極限}
\section{余極限}
\section{極限の存在}
\section{余極限の存在}
\chapter{関手と極限の交換}
\chapter{随伴}
\chapter{モナドとHaskellのMonad}
\chapter{表現可能関手}
\printindex
\end{document}