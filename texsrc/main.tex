\documentclass[dvipdfmx]{jsbook}

% Language setting
% Replace `english' with e.g. `spanish' to change the document language

% Set page size and margins
% Replace `letterpaper' with `a4paper' for UK/EU standard size
\usepackage[letterpaper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}

% Useful packages
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
\usepackage{tikz-cd}
\usepackage{amsthm}
\usepackage{mathrsfs}
\usepackage{comment}
\usepackage{hyperref}
\usepackage{pxjahyper}
\usepackage{bm}
\theoremstyle{plain}

\newtheorem{thm}{定理}[chapter]
\newtheorem{Def}[thm]{定義}
\newtheorem{Notation}[thm]{記法}
\newtheorem{Prop}[thm]{命題}
\newtheorem{caution}[thm]{注意}
\newtheorem{example}[thm]{実例}
\renewcommand{\proofname}{\textbf{証明}}
\usepackage{makeidx}
\usepackage{comment}
\usepackage{listings}
\lstset{
	%プログラム言語(複数の言語に対応，C,C++も可)
 	language = haskell,
 	%背景色と透過度
 	backgroundcolor={\color[gray]{.90}},
 	%枠外に行った時の自動改行
 	breaklines = true,
 	%自動開業後のインデント量(デフォルトでは20[pt])	
 	breakindent = 10pt,
 	%標準の書体
 	basicstyle = \ttfamily\normalsize,
 	%basicstyle = {\small}
 	%コメントの書体
 	commentstyle = {\itshape \color[cmyk]{1,0.4,1,0}},
 	%関数名等の色の設定
 	classoffset = 0,
 	%キーワード(int, ifなど)の書体
 	keywordstyle = {\bfseries \color[cmyk]{0,1,0,0}},
 	%""で囲まれたなどの"文字"の書体
 	stringstyle = {\ttfamily \color[rgb]{0,0,1}},
 	%枠 "t"は上に線を記載, "T"は上に二重線を記載
	%他オプション：leftline，topline，bottomline，lines，single，shadowbox
 	frame = TBrl,
 	%frameまでの間隔(行番号とプログラムの間)
 	framesep = 5pt,
 	%行番号の位置
 	numbers = left,
	%行番号の間隔
 	stepnumber = 1,
	%右マージン
 	%xrightmargin=0zw,
 	%左マージン
	%xleftmargin=3zw,
	%行番号の書体
 	numberstyle = \tiny,
	%タブの大きさ
 	tabsize = 4,
 	%キャプションの場所("tb"ならば上下両方に記載)
 	captionpos = t
}

\makeindex
\title{圏論原論I}
\author{Sexytant}
\begin{document}
\setcounter{tocdepth}{2}
\maketitle
\tableofcontents
\newpage
\part{準備}
\chapter{集合}
\input{ch1/main}


\chapter{代数系}
\input{ch2/main}



\chapter{Haskellの基礎}
関数型プログラミング言語Haskellでは圏論的な視点からライブラリが構築されている.
\section{型}
\subsection{定義済みの型}
Haskellには標準ライブラリに表3.1に示す型が定義済みである.
\begin{table}[h]
\caption{Haskellの標準ライブラリに定義済みの型}
\begin{center}
\begin{tabular}{ll}
\verb|Int|&固定長整数\\
\verb|Integer|&多倍長整数 \\
\verb|Char|&文字\\
\verb|Float|&単精度浮動小数点数\\
\verb|Double|&倍精度浮動小数点数\\
\verb|Bool|&ブール代数\\
\end{tabular}
\end{center}
\end{table}

例として, 固定長整数の変数\verb|a|は次のように宣言する.
\begin{lstlisting}
a :: Int
\end{lstlisting}

\subsection{型構築子}
同じ型の値を一方向に並べ, 前の要素が後の要素のポインタをもつようにしたデータ構造を{\bf リスト}という.
一方, リストに対して, 異なる型を含むことを許容するデータ構造を{\bf タプル}という.

定義済みの型をもとに新たな型を作り出す
Haskellにおいて, 
タプル,リストあるいは\verb|Maybe|のような型構築子によってを無限に作り出すことができる.
\begin{example}
\verb|[Integer]|, \verb|Maybe Int|,
\verb|(Int,[Char])| などはすべてHaskellの型である.
\end{example}
\subsection{データ型}
例として\verb|Red|, \verb|Green|, \verb|Blue|からなるデータ\verb|Color|の宣言は以下のように記述する.
\begin{lstlisting}
data Color = Red | Green | Blue 
\end{lstlisting}
データを表示するためには, \verb|Color| を型クラス \verb|Show| のインスタンスにする必要があることに注意する.
\begin{lstlisting}
data Color = Red | Green | Blue deriving Show
\end{lstlisting}
\subsection{型クラス}
\begin{lstlisting}
class Foo a where
    foo :: a -> String
instance Foo Bool where
    foo True = "Bool: True"
    foo False = "Bool: False"
instance Foo Int where
    foo x = "Int: " ++ show x
instance Foo Char where
    foo x = "Char: " ++ [x]

main = do
    putStrLn $ foo True		-- Bool: True
    putStrLn $ foo (123::Int)	-- Int: 123
    putStrLn $ foo 'A'		-- Char: A
\end{lstlisting}
Foo 型クラスは任意の型(a)を受け取り、Stringを返却するメソッド foo を持っている. instance を用いてそれぞれの型が引数に指定された場合の処理を実装している.
\part{圏論の諸概念}
\chapter{圏}
\section{圏}
\begin{Def}
{\bf 対象}の集合$\mathrm{Obj}$と
{\bf 射}の集合$\mathrm{Mor}$からなり, 以下の演算\footnote{?}が定義されているものを{\bf 圏}という.
\begin{enumerate}
\item 射$f\in\mathrm{Mor}$には{\bf 始域}および{\bf 終域}となる対象がそれぞれ一意に定まる
\item 射$f,g\in\mathrm{Mor}$について,
$f$の終域と$g$の始域が一致するとき,
{\bf 合成射}$g\circ f$が一意に定まる
\item 射の合成は結合律を満たす. すなわち, 射$f,g,h$について, ...であるとき
\[
h\circ(g\circ f)=(h\circ g)\circ f
\]
が成り立つ.
\item 任意の対象$A\in\mathrm{Obj}$について,
次の条件を満たす{\bf 恒等射}$1_{A}:A\rightarrow A$が存在する\footnote{恒等写$1_{A}$は一意に定まるので, 定義に一意性を加えても問題ない.}

条件：任意の射の組$f:A\rightarrow B, g:B\rightarrow A$に対して
$f\circ 1_A=f$かつ$1_A\circ g=g$
\end{enumerate}
\end{Def}
\begin{Notation}
圏$\mathscr{C}$の対象を$\mathrm{Obj}(\mathscr{C})$で表す.
\end{Notation}
\begin{Notation}
圏$\mathscr{C}$の射を$\mathrm{Mor}(\mathscr{C})$で表す.
\end{Notation}
\begin{Notation}
射$f$の始域を$\mathrm{dom}f$で表す.
\end{Notation}
\begin{Notation}
射$f$の終域を$\mathrm{cod}f$で表す.
\end{Notation}
\begin{Notation}
始域が$A$,終域が$B$である射$f$を$f:A\rightarrow B$で表す.
\end{Notation}
\begin{Notation}
圏$\mathscr{C}$の対象$A,B$に対して$f:A\rightarrow B$となる射の全体を$\mathrm{Hom}_{\mathscr{C}}(A,B)$で表す.
\end{Notation}
\begin{Def}
圏$\mathscr{C}$の射$f:A\rightarrow B$に対して,
ある射$g:B\rightarrow A$が存在して$g\circ f=1_A$かつ$f\circ g=1_B$となるとき,
{\bf $f$は同型射である}という. また, このとき$g$を$f$の{\bf 逆射}という.
\end{Def}
\begin{Notation}
射$f$の逆射を$f^{-1}$で表す.
\end{Notation}
\begin{Prop}
ある射の逆射は存在すれば, 一意に定まる
\end{Prop}
\subsection{情報隠蔽された対象の探究に圏論が提供する方法論}
オブジェクト指向プログラミングでは,「知らせる必要のない情報は隠蔽しておくほうが安全である」という{\bf 情報隠蔽}の考え方が重要視される.
これに対して, 圏論は, 対象がもつ情報が隠蔽されている状況下で, 射のみから対象について探究するという方法論を提供する.
\begin{example}
どのような要素をもつかわからない集合$A$について写像$f:A\rightarrow A$が定義されていて$f\circ f\circ f$が恒等写像になるとする.
このとき$A$が3つの要素$a_1,a_2,a_3$をもつと仮定することができ,
\[
f(a_1)=a_2, f(a_2)=a_3, 
f(a_3)=a_1
\]
というように, これらの要素が写像$f$によって回転していると考えることができる.
\end{example}
\subsection{小圏・局所小圏・大圏}
\subsubsection{小圏}
\begin{Def}
対象の集合,射の集合がともに小集合である圏を{\bf 小圏}\index{しょうけん@小圏}という.
\end{Def}
\begin{example}\footnote{実例と命題の区別が曖昧...}
対象も射もない圏${\bf 0}$は小圏である.
\end{example}
\begin{example}
対象が1つで, 恒等射のみをもつ圏${\bf 1}$は小圏である.
\end{example}
\begin{example}
対象が$A,B$の2つで, 
恒等射と射$f:A\rightarrow B$のみをもつ圏
${\bf 2}$は小圏である.
\end{example}
\begin{example}
順序集合は小圏である.
\end{example}
\begin{Def}
すべての対象の組$A,B$に対して$\mathrm{Hom}_{\mathscr{C}}(A,B)$が小集合である圏$\mathscr{C}$を{\bf 局所小圏}という.
\end{Def}
\subsubsection{大圏}
\begin{Def}
小圏でない圏を{\bf 大圏}という.
\end{Def}

\begin{example}
すべての小集合\footnote{「宇宙」で定義しているが, 現在本文から外している}を対象とし, それらの間の写像を射とする圏$\mathrm{Set}$は大圏である.
\end{example}
\begin{example}
すべての群を対象とし, それらの間の準同型写像を射とする圏$\mathrm{Grp}$は大圏である.
\end{example}
\begin{example}
すべてのアーベル群を対象とし, それらの間の準同型写像を射とする圏$\mathrm{Ab}$は大圏である.
\end{example}
\begin{example}
すべての位相空間\footnote{定義を本文から外している}を対象とし, それらの間の連続写像\footnote{定義を本文から外している}を射とする圏$\mathrm{Top}$は大圏である.
\end{example}
\begin{example}
ある体\footnote{定義した箇所をコメントアウトしている}$k$に対して,
すべての$k$次線形空間\footnote{未定義？}を対象とし,
それらの間の$k$次線形写像\footnote{未定義？}を射とする
圏$\mathrm{Vect}_k$は大圏である.
\end{example}
\subsection{部分圏}
\begin{Notation}
圏$C$における射$f,g\in\mathrm{Mor}(\mathscr{C})$の合成を$g\circ_{\mathscr{C}}f$で表す.
\end{Notation}
\begin{Def}
圏$\mathscr{A}$が圏$\mathscr{B}$に対して, 以下の$3$条件を満たすとき, {\bf $\mathscr{A}$は$\mathscr{B}$の部分圏である}という.
\begin{enumerate}
\item $\mathrm{Obj}(\mathscr{A})$が$\mathrm{Obj}(\mathscr{B})$の部分集合である.
\item 圏$\mathscr{A}$の2つの対象の組の全体が,
圏$\mathscr{B}$の2つの対象の組の全体の部分集合である.
\item
\end{enumerate}
\end{Def}
\begin{example}
圏$\mathrm{Ab}$\footnote{ref}は圏$\mathrm{Grp}$\footnote{ref}の部分圏である.
\end{example}
\subsection{双対}
\begin{Def}
任意の圏$\mathscr{C}$に対して, 対象が$\mathscr{C}$と同じで, 射の向きが$\mathcal{C}$と反対になっている圏を\bf{双対圏}\index{そうついけん@双対圏}という.
\end{Def}
\begin{Notation}
圏$\mathscr{C}$の双対圏を$\mathscr{C}^{\mathrm{op}}$と表す.
\end{Notation}
\begin{caution}
双対の原理
\end{caution}
\subsection{圏の生成}
\begin{Prop}
集合$A$に対して写像$f:A\rightarrow A$を定める.
このとき, 対象の集合$\mathrm{Obj}=\{A\}$と, 射の集合$\mathrm{Mor}=\{1_A,f\}$からなる圏を得ることができる.
ここで, 射$1_A$は$A$についての恒等射である.
\end{Prop}
\begin{comment}
\begin{proof}
$\mathrm{dom} f=\mathrm{cod}f$であるから, 合成射$f\circ f$を定めることができる.
このとき$f\circ f=1_A$もしくは$f\circ f=f$である.

$f\circ f=1_A$ならば...

...

となる.
一方, $f\circ f=1_A$ならば...

...

となる.
以上より, いずれの場合も, 射の合成が結合律を満たすことがわかる.
したがって$f\circ f=1_A$と定めても$f\circ f=f$と定めても圏を生成することができる.
\end{proof}
\end{comment}
\begin{Prop}
集合$A$に対して写像$f:A\rightarrow A$を定め, 正の整数$n$に対して$f^n=\underbrace{f\circ f \circ \dots \circ f}_{n}$
とする.
このとき, 対象の集合$\mathrm{Obj}=\{A\}$と, 射の集合$\mathrm{Mor}=\{1_A,f,f^2,\dots,f^n,\dots\}$からなる圏を得ることができる.
ここで, 射$1_A$は$A$についての恒等射である.
\end{Prop}
\begin{comment}
\begin{proof}
\end{proof}
\end{comment}
\begin{Prop}
集合$A,B$に対して,写像$f:A\rightarrow B$と$g:\rightarrow A$を定める.
このとき, 対象の集合$\mathrm{Obj}=\{A,B\}$と射の集合$\mathrm{Mor}=\{1_A,1_B,f,g,f\circ g\}$からなる圏を得ることができる.
ここで, 射$1_A,1_B$はそれぞれ$A,B$についての恒等射である.
\end{Prop}
\begin{comment}
\begin{proof}
\end{proof}
\end{comment}
\begin{Def}
集合$S_1,\dots,S_N$に関する写像$f_1,\dots,f_M$について,
対象の集合を$\{S_1,\dots,S_N\}$,
射の集合を恒等射と$f_1,\dots,f_M$およびそれらの合成のみからなる集合とする圏が存在するとき, 射の列$\{f_1,\dots,f_M\}$を{\bf 生成系 system of generators}という.
{\bf 生成系}
\end{Def}
{\bf 生成元}

{\bf 関係}

\begin{Def}
圏の積を次で定義する
\end{Def}
\begin{Prop}
圏の積は圏である.
\end{Prop}
\section{Haskellにおける圏 (Hask)}
\begin{Prop}
すべてのHaskellの型を対象とし, それらの間の関数を射とする圏Haskは小圏である.
\end{Prop}
\begin{proof}
\end{proof}
\begin{caution}
Haskellにおいて, 型\verb|A|,\verb|B|に対して, 型構築子によってつくられる\verb|A->B|は1つの型となる.
\end{caution}
\chapter{関手}
\section{関手}
\begin{Def}
圏$\mathscr{A}$の対象$\mathrm{Obj}(\mathscr{A})$から圏$\mathscr{B}$の対象$\mathrm{Obj}(\mathscr{B})$への関数を
{\bf $\mathscr{A}$から$\mathscr{B}$への対象関数}という.
\end{Def}
\begin{Def}
{\bf 射関数}
\end{Def}
\begin{Def}
圏$\mathscr{A},\mathscr{B}$に対する対称関数と射関数の組を{\bf $\mathscr{A}$から$\mathscr{B}$への関手}という.
\end{Def}
\begin{example}
順序を保存する写像
\end{example}
\begin{example}
$n$次ホモロジー関手
\end{example}
\begin{example}
\end{example}
\begin{example}
\end{example}
\subsection{反変関手}
\begin{Def}
圏$A^{\mathrm{op}}$から圏$B$への関手
を{\bf 圏$A$から圏$B$への反変関手}という.
\end{Def}
\begin{example}
\end{example}
\begin{Notation}
\end{Notation}
\begin{caution}
\end{caution}
\subsection{定数関手}
\begin{Def}
圏$\mathscr{A}$の任意の対象$A$を圏$\mathscr{B}$のただ一つの対象$B_0$に写し,
$\mathscr{A}$の任意の射$f$を圏$\mathscr{B}$の恒等射に写す関手を
{\bf 定数関手}\index{ていすうかんしゅ@定数関手}という
\end{Def}

\subsection{忠実関手と充満関手}
\begin{Def}
圏$\mathscr{A}$
から圏$\mathscr{B}$への関手$F$に関して,
集合$\{(A_1,A_2)\mid A_1,A_2\in\mathrm{Obj}(\mathscr{A})\}$
から
集合$\{(F(A_1),F(A_2))\mid\mathrm{Obj}(\mathscr{A}))\}$
への写像が単射となっているとき,
{\bf 関手$F$は忠実}であるという.
\end{Def}
\begin{Def}
圏$\mathscr{A}$から圏$\mathscr{B}$への関手$F$に関して,
集合$\{(A_1,A_2)\mid A_1,A_2\in\mathrm{Obj}(\mathscr{A})\}$
から
集合$\{(F(A_1),F(A_2))\mid\mathrm{Obj}(\mathscr{A}))\}$
への写像が全射となっているとき,
{\bf 関手$F$は充満}であるという.
\end{Def}
\begin{Def}圏$\mathscr{A}$から圏$\mathscr{B}$への関手$F$が忠実かつ充満であるとき
{\bf 関手$F$は充満忠実である}という
\end{Def}
\begin{Def}
圏$\mathscr{A}$が圏$\mathscr{A}$の部分圏であり, 関手$F:\mathscr{A}\rightarrow\mathscr{B}$が充満であるとき,
{\bf 圏$\mathscr{A}$は圏 $\mathscr{B}$の充満部分圏である}という.
\end{Def}
\begin{example}
...充満忠実である.
\end{example}
\begin{example}
...忠実だが充満でない
\end{example}
\begin{example}
充満だが忠実でない
\end{example}
\begin{example}
複素数...

...

...忠実だが充満でない. （例1.30)
\end{example}
\subsection{埋め込み関手}
\subsection{忘却関手}
\section{Haskellの型構築子と関手}
\subsubsection{List関手}
Haskellにおける型構築子\verb|[]|は任意の型\verb|A|に対して型\verb|[A]|を対応させる.
これは, HaskからHaskへの対称関数とみなせる.
型\verb|A|と型\verb|B|および関数\verb|f::A->B|が与えられとき\verb|map f::[A]->[B]|が決定される.

...

型構築子\verb|[]|は{\bf List関手}\index{りすとかんしゅ@List関手}と呼ばれる
\subsubsection{Maybe関手}
Haskellにおける型構築子\verb|Maybe|は...

...

型構築子\verb|Maybe|は{\bf Maybe関手}\index{めいびーかんしゅ@Maybe関手}
と呼ばれる.
\subsubsection{Tree関手}
一般に木構造を生成する型構築子は関手にできる. これを{\bf Tree関手}と呼ぶ.

\lstinputlisting{src/haskell/Tree.hs}
\section{２変数の関手}
{\bf Hom関手}
\lstinputlisting{src/haskell/homfunctors.hs}
\section{型クラスとHaskの部分圏}
{\bf ソート関手}
\lstinputlisting{src/haskell/sort.hs}

\chapter{自然変換}
\section{自然変換}
\begin{Def}
圏$\mathscr{A}$から圏$\mathscr{B}$への関手$F,G$について,
\begin{enumerate}
\item $\mathscr{A}$の任意の対象$A$ 
に対して
$\mathscr{B}$の射$\alpha_A:FA\rightarrow GA$
が存在し
\item $\mathscr{A}$の任意の射$f:A_1\rightarrow A_2$
が
\[
\alpha_{A_2}\circ Ff
=Gf\circ\alpha_{A_1}
\]
を満たすとき
\end{enumerate}に対して
{\bf 集合$\alpha=\{\alpha_A\mid A\in\mathrm{Obj}(\mathscr{A})\}$は関手$F$から関手$G$への自然変換\index{しぜんへんかん@自然変換}である}という.
\end{Def}
\begin{Notation}
関手$F$から関手$G$への自然変換$\alpha$を$\alpha:F\rightarrow G$で表す.
\end{Notation}
\begin{Notation}
関手$F$から関手$G$への自然変換$\alpha$を次の図表で表す.
\end{Notation}
\section{Haskにおける自然変換}
\subsection{concat}
\subsection{List関手からMaybe関手への自然変換safehead}
\subsection{concatとsafeheadの垂直合成}
\subsection{二分木からリストへのflatten関数}

\section{Haskにおける定数関手}
\subsection{length関数}

\chapter{関手圏}
\section{関手圏}
\begin{Prop}
...は圏である.
\end{Prop}
\begin{Def}
{\bf $\mathscr{A}$から$\mathscr{B}$への関手圏}という.
\end{Def}
\begin{Notation}
$\mathscr{A}$から$\mathscr{B}$への関手圏を$[\mathscr{A},\mathscr{B}]$
で表す\end{Notation}
\begin{Def}
関手圏における同型射を自然同型という.
\bf{自然同型}
\end{Def}
\begin{Prop}
自然変換...が自然同型であること,

...が同型者であることは同値である.
\end{Prop}
\chapter{圏同値}
\section{圏同値}
\begin{Def}
\bf{圏同値}
\end{Def}

\section{Haskにおける自然同型}
\subsection{mirror関数}
Tree関手からTree関手への自然同型
\subsection{Maybe関手とEither()関手の間の自然同型}
\section{まとめ}
aa
\printindex
\end{document}
